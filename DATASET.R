setwd('C:/Users/jonat/Desktop/datos')
library(readr)
GALE1=1575.42*10^6
GALE5a=1176.45*10^6
GPSL1=1575.42*10^6
GPSL2=1227.60*10^6
LAMR=-(78+26/60+46.76/3600)*pi/180
PHIR=-(0+18/60+53.6/3600)*pi/180
MEAS2019 <- read_csv("MEAS2019.csv", col_names = FALSE)
MEAS2019$X1<-NULL
MEAS2019$X10<-NULL
MEAS2019[20:24]=list(NULL)

GAL2019F15=MEAS2019[MEAS2019$X7>15 & MEAS2019$X5=='GAL',]
GAL2019F15$X21=90-GAL2019F15$X7
GALC=(((GALE1*GALE5a)^2)/(40.31*10^16*(GALE1^2-GALE5a^2)))
GAL2019F15$STEC=GALC*(GAL2019F15$X19-GAL2019F15$X11)
GAL2019F15=GAL2019F15[GAL2019F15$STEC>0 & GAL2019F15$STEC<10^5,]
GAL2019F15$VTEC=GAL2019F15$STEC*sqrt(1-(6378137*sinpi(GAL2019F15$X21/180)/(6378137+350000))^2)
GAL2019F15$PSI=pi/2-asin(6378137*cos(GAL2019F15$X7*pi/180)/(6378137+350000))-GAL2019F15$X7*pi/180
GAL2019F15$PHI=asin(sin(PHIR)*cos(GAL2019F15$PSI)+cos(PHIR)*sin(GAL2019F15$PSI)*cos(GAL2019F15$X8*pi/180))
GAL2019F15$LAM=LAMR+GAL2019F15$PSI*sin(GAL2019F15$X8*pi/180)/cos(GAL2019F15$PHI)

GPS2019F15=MEAS2019[MEAS2019$X7>15 & MEAS2019$X5=='GPS',]
GPS2019F15$X21=90-GPS2019F15$X7
GPSC=(((GPSL1*GPSL2)^2)/(40.31*10^16*(GPSL1^2-GPSL2^2)))
GPS2019F15$STEC=GPSC*(GPS2019F15$X15-GPS2019F15$X11)
GPS2019F15=GPS2019F15[GPS2019F15$STEC>0 & GPS2019F15$STEC<10^5,]
GPS2019F15$VTEC=GPS2019F15$STEC*sqrt(1-(6378137*sinpi(GPS2019F15$X21/180)/(6378137+350000))^2)
GPS2019F15$PSI=pi/2-asin(6378137*cos(GPS2019F15$X7*pi/180)/(6378137+350000))-GPS2019F15$X7*pi/180
GPS2019F15$PHI=asin(sin(PHIR)*cos(GPS2019F15$PSI)+cos(PHIR)*sin(GPS2019F15$PSI)*cos(GPS2019F15$X8*pi/180))
GAL2019F15$LAM=LAMR+GAL2019F15$PSI*sin(GAL2019F15$X8*pi/180)/cos(GAL2019F15$PHI)